–ö–æ–Ω–µ—á–Ω–æ! –ù–∏–∂–µ –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω –ø—Ä–∏–º–µ—Ä **—Ä–µ–≥–ª–∞–º–µ–Ω—Ç–∞ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è Ansible –≤ –æ—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏–∏**. –≠—Ç–æ—Ç –¥–æ–∫—É–º–µ–Ω—Ç –º–æ–∂–µ—Ç –±—ã—Ç—å –∞–¥–∞–ø—Ç–∏—Ä–æ–≤–∞–Ω –ø–æ–¥ –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã–µ –ø–æ—Ç—Ä–µ–±–Ω–æ—Å—Ç–∏ –≤–∞—à–µ–π –∫–æ–º–∞–Ω–¥—ã, –∏–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä—É –∏ –ø–æ–ª–∏—Ç–∏–∫–∏ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏.

---

# –†–µ–≥–ª–∞–º–µ–Ω—Ç –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è Ansible –≤ –æ—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏–∏

**–í–µ—Ä—Å–∏—è:** 1.0  
**–î–∞—Ç–∞ –≤—Å—Ç—É–ø–ª–µ–Ω–∏—è –≤ —Å–∏–ª—É:** [—É–∫–∞–∑–∞—Ç—å –¥–∞—Ç—É]  
**–û—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω—ã–π –∑–∞ –ø–æ–¥–¥–µ—Ä–∂–∫—É:** [–ò–º—è/–î–æ–ª–∂–Ω–æ—Å—Ç—å/–ö–æ–º–∞–Ω–¥–∞, –Ω–∞–ø—Ä–∏–º–µ—Ä, DevOps-–∫–æ–º–∞–Ω–¥–∞]

---

## 1. –û–±—â–∏–µ –ø–æ–ª–æ–∂–µ–Ω–∏—è

1.1. –ù–∞—Å—Ç–æ—è—â–∏–π —Ä–µ–≥–ª–∞–º–µ–Ω—Ç –æ–ø—Ä–µ–¥–µ–ª—è–µ—Ç –ø—Ä–∞–≤–∏–ª–∞, —Å—Ç–∞–Ω–¥–∞—Ä—Ç—ã –∏ –ø—Ä–æ—Ü–µ–¥—É—Ä—ã –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è —Å–∏—Å—Ç–µ–º—ã –∞–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏–∏ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–π **Ansible** –≤ —Ä–∞–º–∫–∞—Ö –ò–¢-–∏–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä—ã –æ—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏–∏.

1.2. –¶–µ–ª—å —Ä–µ–≥–ª–∞–º–µ–Ω—Ç–∞ ‚Äî –æ–±–µ—Å–ø–µ—á–∏—Ç—å:
- –µ–¥–∏–Ω–æ–æ–±—Ä–∞–∑–∏–µ –∏ –ø—Ä–µ–¥—Å–∫–∞–∑—É–µ–º–æ—Å—Ç—å —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –∏–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä–æ–π;
- –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å –∏ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏–µ –ø–æ–ª–∏—Ç–∏–∫–∞–º –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–æ–Ω–Ω–æ–π –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏;
- –≤–æ—Å–ø—Ä–æ–∏–∑–≤–æ–¥–∏–º–æ—Å—Ç—å –∏ –∞—É–¥–∏—Ä—É–µ–º–æ—Å—Ç—å –∏–∑–º–µ–Ω–µ–Ω–∏–π;
- —É–ø—Ä–æ—â–µ–Ω–∏–µ —Å–æ–ø—Ä–æ–≤–æ–∂–¥–µ–Ω–∏—è –∏ –ø–µ—Ä–µ–¥–∞—á–∏ –∑–Ω–∞–Ω–∏–π –º–µ–∂–¥—É —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–∞–º–∏.

1.3. –†–µ–≥–ª–∞–º–µ–Ω—Ç –æ–±—è–∑–∞—Ç–µ–ª–µ–Ω –¥–ª—è –≤—Å–µ—Ö —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–æ–≤, –ø–æ–¥—Ä—è–¥—á–∏–∫–æ–≤ –∏ —Å—Ç–æ—Ä–æ–Ω–Ω–∏—Ö —Å–ø–µ—Ü–∏–∞–ª–∏—Å—Ç–æ–≤, –∏–º–µ—é—â–∏—Ö –¥–æ—Å—Ç—É–ø –∫ –∏–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä–µ –∏ –∏—Å–ø–æ–ª—å–∑—É—é—â–∏—Ö Ansible.

---

## 2. –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ –∏ —Ä–∞–∑–º–µ—â–µ–Ω–∏–µ –∫–æ–¥–∞

2.1. –í—Å–µ Ansible-–ø—Ä–æ–µ–∫—Ç—ã (playbooks, roles, inventory –∏ —Ç.–¥.) –¥–æ–ª–∂–Ω—ã —Ö—Ä–∞–Ω–∏—Ç—å—Å—è –≤ —Ü–µ–Ω—Ç—Ä–∞–ª–∏–∑–æ–≤–∞–Ω–Ω–æ–º —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–∏ —Å–∏—Å—Ç–µ–º—ã –∫–æ–Ω—Ç—Ä–æ–ª—è –≤–µ—Ä—Å–∏–π (–Ω–∞–ø—Ä–∏–º–µ—Ä, GitLab/GitHub/Bitbucket).

2.2. –î–ª—è –∫–∞–∂–¥–æ–≥–æ –ø—Ä–æ–µ–∫—Ç–∞ (–∏–ª–∏ –≥—Ä—É–ø–ø—ã —Å–≤—è–∑–∞–Ω–Ω—ã—Ö –ø—Ä–æ–µ–∫—Ç–æ–≤) —Å–æ–∑–¥–∞—ë—Ç—Å—è –æ—Ç–¥–µ–ª—å–Ω—ã–π —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π –∏–ª–∏ –ø–æ–¥–∫–∞—Ç–∞–ª–æ–≥ —Å –ø–æ–Ω—è—Ç–Ω–æ–π —Å—Ç—Ä—É–∫—Ç—É—Ä–æ–π.

2.3. –†–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—É—é —Å—Ç—Ä—É–∫—Ç—É—Ä—É –ø—Ä–æ–µ–∫—Ç–∞ –ø–æ [Ansible Best Practices](https://docs.ansible.com/ansible/latest/user_guide/playbooks_best_practices.html).

2.4. –ó–∞–ø—Ä–µ—â–µ–Ω–æ —Ö—Ä–∞–Ω–∏—Ç—å —á—É–≤—Å—Ç–≤–∏—Ç–µ–ª—å–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ (–ø–∞—Ä–æ–ª–∏, –∫–ª—é—á–∏, —Ç–æ–∫–µ–Ω—ã) –≤ –æ—Ç–∫—Ä—ã—Ç–æ–º –≤–∏–¥–µ –≤ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–∏.

---

## 3. –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Å–µ–∫—Ä–µ—Ç–∞–º–∏

3.1. –í—Å–µ —Å–µ–∫—Ä–µ—Ç—ã (–ø–∞—Ä–æ–ª–∏, SSH-–∫–ª—é—á–∏, API-—Ç–æ–∫–µ–Ω—ã –∏ —Ç.–¥.) –¥–æ–ª–∂–Ω—ã —à–∏—Ñ—Ä–æ–≤–∞—Ç—å—Å—è —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º **Ansible Vault**.

3.2. –ö–ª—é—á–∏ —à–∏—Ñ—Ä–æ–≤–∞–Ω–∏—è (vault password) —Ö—Ä–∞–Ω—è—Ç—Å—è –≤ –∑–∞—â–∏—â—ë–Ω–Ω–æ–º –º–µ–Ω–µ–¥–∂–µ—Ä–µ —Å–µ–∫—Ä–µ—Ç–æ–≤ (–Ω–∞–ø—Ä–∏–º–µ—Ä, HashiCorp Vault, AWS Secrets Manager, CyberArk) –∏ –Ω–µ–¥–æ—Å—Ç—É–ø–Ω—ã –Ω–∞–ø—Ä—è–º—É—é —Ä–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫–∞–º.

3.3. –ü—Ä–∏ –ª–æ–∫–∞–ª—å–Ω–æ–π —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–µ –¥–æ–ø—É—Å–∫–∞–µ—Ç—Å—è –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –≤—Ä–µ–º–µ–Ω–Ω—ã—Ö vault-—Ñ–∞–π–ª–æ–≤ —Å —Ç–µ—Å—Ç–æ–≤—ã–º–∏ –¥–∞–Ω–Ω—ã–º–∏, –Ω–æ –æ–Ω–∏ **–Ω–µ –¥–æ–ª–∂–Ω—ã –ø–æ–ø–∞–¥–∞—Ç—å –≤ –æ—Å–Ω–æ–≤–Ω—É—é –≤–µ—Ç–∫—É** —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏—è.

3.4. –î–æ—Å—Ç—É–ø –∫ —Å–µ–∫—Ä–µ—Ç–∞–º –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª—è–µ—Ç—Å—è –ø–æ –ø—Ä–∏–Ω—Ü–∏–ø—É **–º–∏–Ω–∏–º–∞–ª—å–Ω—ã—Ö –ø—Ä–∏–≤–∏–ª–µ–≥–∏–π** –∏ —Ç–æ–ª—å–∫–æ –ø–æ –∑–∞–ø—Ä–æ—Å—É —Å –æ–±–æ—Å–Ω–æ–≤–∞–Ω–∏–µ–º.

---

## 4. –í–µ—Ä—Å–∏–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ –∏ –≤–µ—Ç–≤–ª–µ–Ω–∏–µ

4.1. –û—Å–Ω–æ–≤–Ω–∞—è —Ä–∞–±–æ—á–∞—è –≤–µ—Ç–∫–∞ ‚Äî `main` (–∏–ª–∏ `master`). –í –Ω–µ—ë —Ä–∞–∑—Ä–µ—à–µ–Ω–æ –º–µ—Ä–∂–∏—Ç—å —Ç–æ–ª—å–∫–æ –ø—Ä–æ—à–µ–¥—à–∏–µ –ø—Ä–æ–≤–µ—Ä–∫—É –∏–∑–º–µ–Ω–µ–Ω–∏—è.

4.2. –í—Å–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è –≤–Ω–æ—Å—è—Ç—Å—è —á–µ—Ä–µ–∑ **feature-–≤–µ—Ç–∫–∏** –∏ **merge/pull request** —Å –æ–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–º –∫–æ–¥-—Ä–µ–≤—å—é –∫–∞–∫ –º–∏–Ω–∏–º—É–º –æ—Ç –æ–¥–Ω–æ–≥–æ –∫–æ–ª–ª–µ–≥–∏.

4.3. –î–ª—è production-–æ–∫—Ä—É–∂–µ–Ω–∏—è –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è —Ç–µ–≥–∏—Ä–æ–≤–∞–Ω–Ω–∞—è –≤–µ—Ä—Å–∏—è (–Ω–∞–ø—Ä–∏–º–µ—Ä, `v1.2.3`) –∏–ª–∏ –æ—Ç–¥–µ–ª—å–Ω–∞—è –≤–µ—Ç–∫–∞ (–Ω–∞–ø—Ä–∏–º–µ—Ä, `production`), —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∏—Ä—É–µ–º–∞—è –ø–æ —Ä–∞—Å–ø–∏—Å–∞–Ω–∏—é –∏–ª–∏ –ø–æ –∑–∞–ø—Ä–æ—Å—É.

---

## 5. –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –∏ –≤–∞–ª–∏–¥–∞—Ü–∏—è

5.1. –í—Å–µ playbooks –∏ —Ä–æ–ª–∏ –¥–æ–ª–∂–Ω—ã –±—ã—Ç—å –ø–æ–∫—Ä—ã—Ç—ã —Ç–µ—Å—Ç–∞–º–∏ (–Ω–∞–ø—Ä–∏–º–µ—Ä, —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º **Molecule**, **Testinfra** –∏–ª–∏ **pytest**).

5.2. –ü–µ—Ä–µ–¥ –º–µ—Ä–∂–µ–º –≤ –æ—Å–Ω–æ–≤–Ω—É—é –≤–µ—Ç–∫—É –∑–∞–ø—É—Å–∫–∞–µ—Ç—Å—è CI-–ø–∞–π–ø–ª–∞–π–Ω, –≤–∫–ª—é—á–∞—é—â–∏–π:
- —Å–∏–Ω—Ç–∞–∫—Å–∏—á–µ—Å–∫—É—é –ø—Ä–æ–≤–µ—Ä–∫—É (`ansible-playbook --syntax-check`);
- –ª–∏–Ω—Ç–∏–Ω–≥ (–Ω–∞–ø—Ä–∏–º–µ—Ä, `ansible-lint`);
- unit/integration-—Ç–µ—Å—Ç—ã;
- –ø—Ä–æ–≤–µ—Ä–∫—É –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏ (–Ω–∞–ø—Ä–∏–º–µ—Ä, `bandit`, `gitleaks`).

5.3. –ó–∞–ø—Ä–µ—â–µ–Ω–æ –∑–∞–ø—É—Å–∫–∞—Ç—å –Ω–µ –ø—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ playbooks –≤ production-—Å—Ä–µ–¥–µ.

---

## 6. –ó–∞–ø—É—Å–∫ –∏ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ

6.1. –ó–∞–ø—É—Å–∫ Ansible –≤ production-—Å—Ä–µ–¥–µ –≤–æ–∑–º–æ–∂–µ–Ω **—Ç–æ–ª—å–∫–æ —á–µ—Ä–µ–∑ CI/CD-—Å–∏—Å—Ç–µ–º—É** (–Ω–∞–ø—Ä–∏–º–µ—Ä, GitLab CI, Jenkins, AWX/Ansible Tower), –∑–∞ –∏—Å–∫–ª—é—á–µ–Ω–∏–µ–º —ç–∫—Å—Ç—Ä–µ–Ω–Ω—ã—Ö —Å–ª—É—á–∞–µ–≤.

6.2. –í —ç–∫—Å—Ç—Ä–µ–Ω–Ω—ã—Ö —Å–ª—É—á–∞—è—Ö (–Ω–∞–ø—Ä–∏–º–µ—Ä, —Å–±–æ–π –∏–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä—ã) —Ä–∞–∑—Ä–µ—à—ë–Ω —Ä—É—á–Ω–æ–π –∑–∞–ø—É—Å–∫ —Å –æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ–π –ø–æ—Å–ª–µ–¥—É—é—â–µ–π —Ñ–∏–∫—Å–∞—Ü–∏–µ–π –∏–∑–º–µ–Ω–µ–Ω–∏–π –≤ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–∏ –∏ –ø–æ—Å—Ç-–º–æ—Ä—Ç–µ–º-–∞–Ω–∞–ª–∏–∑–æ–º.

6.3. –í—Å–µ –∑–∞–ø—É—Å–∫–∏ –¥–æ–ª–∂–Ω—ã –ª–æ–≥–∏—Ä–æ–≤–∞—Ç—å—Å—è, –∞ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã ‚Äî —Å–æ—Ö—Ä–∞–Ω—è—Ç—å—Å—è (–Ω–∞–ø—Ä–∏–º–µ—Ä, —á–µ—Ä–µ–∑ Ansible Tower/AWX –∏–ª–∏ –∫–∞—Å—Ç–æ–º–Ω—ã–π –ª–æ–≥–≥–µ—Ä).

6.4. –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ —Ñ–ª–∞–≥–∞ `--check` (dry-run) —Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è –ø–µ—Ä–µ–¥ –ª—é–±—ã–º –∏–∑–º–µ–Ω–µ–Ω–∏–µ–º –≤ production.

---

## 7. –î–æ–∫—É–º–µ–Ω—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

7.1. –ö–∞–∂–¥—ã–π playbook –∏ —Ä–æ–ª—å –¥–æ–ª–∂–µ–Ω —Å–æ–ø—Ä–æ–≤–æ–∂–¥–∞—Ç—å—Å—è —Ñ–∞–π–ª–æ–º `README.md`, –æ–ø–∏—Å—ã–≤–∞—é—â–∏–º:
- –Ω–∞–∑–Ω–∞—á–µ–Ω–∏–µ;
- –≤—Ö–æ–¥–Ω—ã–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã (vars);
- –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏;
- –ø—Ä–∏–º–µ—Ä—ã –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è.

7.2. –ò–∑–º–µ–Ω–µ–Ω–∏—è –≤ –∏–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä–µ —Ñ–∏–∫—Å–∏—Ä—É—é—Ç—Å—è –≤ changelog –∏–ª–∏ —á–µ—Ä–µ–∑ –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–∏ –≤ merge request.

---

## 8. –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å –∏ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏–µ

8.1. –í—Å–µ Ansible-—Ö–æ—Å—Ç—ã –¥–æ–ª–∂–Ω—ã –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å **SSH-–∫–ª—é—á–∏** –≤–º–µ—Å—Ç–æ –ø–∞—Ä–æ–ª–µ–π (–≥–¥–µ –≤–æ–∑–º–æ–∂–Ω–æ).

8.2. –£—á—ë—Ç–Ω—ã–µ –∑–∞–ø–∏—Å–∏ –¥–ª—è –∑–∞–ø—É—Å–∫–∞ Ansible –¥–æ–ª–∂–Ω—ã –∏–º–µ—Ç—å **–º–∏–Ω–∏–º–∞–ª—å–Ω–æ –Ω–µ–æ–±—Ö–æ–¥–∏–º—ã–µ –ø—Ä–∞–≤–∞** (–ø—Ä–∏–Ω—Ü–∏–ø least privilege).

8.3. –ó–∞–ø—Ä–µ—â–µ–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ `become: yes` –±–µ–∑ —è–≤–Ω–æ–≥–æ –æ–±–æ—Å–Ω–æ–≤–∞–Ω–∏—è –∏ —Ä–µ–≤—å—é.

8.4. –í—Å–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è –≤ –∏–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä–µ –ø–æ–¥–ª–µ–∂–∞—Ç –∞—É–¥–∏—Ç—É –∏ –¥–æ–ª–∂–Ω—ã –±—ã—Ç—å –≤–æ—Å–ø—Ä–æ–∏–∑–≤–æ–¥–∏–º—ã –∏–∑ –∫–æ–¥–∞.

---

## 9. –û—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ—Å—Ç—å

9.1. –í–ª–∞–¥–µ–ª—å—Ü–µ–º –∫–∞–∂–¥–æ–≥–æ Ansible-–ø—Ä–æ–µ–∫—Ç–∞ –Ω–∞–∑–Ω–∞—á–∞–µ—Ç—Å—è –æ—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ–µ –ª–∏—Ü–æ (–∏–ª–∏ –∫–æ–º–∞–Ω–¥–∞), –æ—Ç–≤–µ—á–∞—é—â–µ–µ –∑–∞ –µ–≥–æ –ø–æ–¥–¥–µ—Ä–∂–∫—É, –∞–∫—Ç—É–∞–ª—å–Ω–æ—Å—Ç—å –∏ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å.

9.2. –ù–∞—Ä—É—à–µ–Ω–∏–µ —Ä–µ–≥–ª–∞–º–µ–Ω—Ç–∞ –º–æ–∂–µ—Ç –ø–æ–≤–ª–µ—á—å –∑–∞ —Å–æ–±–æ–π –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ –¥–æ—Å—Ç—É–ø–∞ –∫ –∏–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä–µ –∏ –¥–∏—Å—Ü–∏–ø–ª–∏–Ω–∞—Ä–Ω—ã–µ –º–µ—Ä—ã –≤ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏–∏ —Å –≤–Ω—É—Ç—Ä–µ–Ω–Ω–∏–º–∏ –ø—Ä–∞–≤–∏–ª–∞–º–∏ –æ—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏–∏.

---

## 10. –ü–µ—Ä–µ—Å–º–æ—Ç—Ä —Ä–µ–≥–ª–∞–º–µ–Ω—Ç–∞

10.1. –ù–∞—Å—Ç–æ—è—â–∏–π —Ä–µ–≥–ª–∞–º–µ–Ω—Ç –ø–µ—Ä–µ—Å–º–∞—Ç—Ä–∏–≤–∞–µ—Ç—Å—è –Ω–µ —Ä–µ–∂–µ –æ–¥–Ω–æ–≥–æ —Ä–∞–∑–∞ –≤ –≥–æ–¥ –∏–ª–∏ –ø–æ –º–µ—Ä–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è —Ç—Ä–µ–±–æ–≤–∞–Ω–∏–π –∫ –∏–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä–µ, –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏ –∏–ª–∏ –ø—Ä–æ—Ü–µ—Å—Å–∞–º.

10.2. –ü—Ä–µ–¥–ª–æ–∂–µ–Ω–∏—è –ø–æ –∏–∑–º–µ–Ω–µ–Ω–∏—é —Ä–µ–≥–ª–∞–º–µ–Ω—Ç–∞ –º–æ–≥—É—Ç –≤–Ω–æ—Å–∏—Ç—å –ª—é–±—ã–µ —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–∏ —á–µ—Ä–µ–∑ –≤–Ω—É—Ç—Ä–µ–Ω–Ω—é—é —Å–∏—Å—Ç–µ–º—É —Ç—Ä–µ–∫–∏–Ω–≥–∞ –∑–∞–¥–∞—á.

---

**–£—Ç–≤–µ—Ä–∂–¥–µ–Ω–æ:**  
[–§–ò–û, –î–æ–ª–∂–Ω–æ—Å—Ç—å, –ü–æ–¥–ø–∏—Å—å]  
[–î–∞—Ç–∞]

---

–ï—Å–ª–∏ –≤—ã –∏—Å–ø–æ–ª—å–∑—É–µ—Ç–µ **Ansible Tower / AWX**, –º–æ–∂–Ω–æ –¥–æ–±–∞–≤–∏—Ç—å –æ—Ç–¥–µ–ª—å–Ω—ã–π —Ä–∞–∑–¥–µ–ª –ø–æ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—é —á–µ—Ä–µ–∑ –≤–µ–±-–∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å, —Ä–æ–ª—è–º –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π, —à–∞–±–ª–æ–Ω–∞–º –∑–∞–¥–∞–Ω–∏–π –∏ —Ç.–¥.

–•–æ—Ç–∏—Ç–µ, —á—Ç–æ–±—ã —è –∞–¥–∞–ø—Ç–∏—Ä–æ–≤–∞–ª —ç—Ç–æ—Ç —Ä–µ–≥–ª–∞–º–µ–Ω—Ç –ø–æ–¥ –∫–æ–Ω–∫—Ä–µ—Ç–Ω—É—é –∏–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä—É (–Ω–∞–ø—Ä–∏–º–µ—Ä, –æ–±–ª–∞–∫–æ AWS, Kubernetes, –≥–∏–±—Ä–∏–¥–Ω—É—é —Å—Ä–µ–¥—É) –∏–ª–∏ –¥–æ–±–∞–≤–∏–ª —à–∞–±–ª–æ–Ω—ã CI/CD?

–ö–æ–Ω–µ—á–Ω–æ! –ù–∏–∂–µ –¥–æ–ø–æ–ª–Ω–µ–Ω–∏–µ –∫ —Ä–µ–≥–ª–∞–º–µ–Ω—Ç—É ‚Äî **—Ä–∞–∑–¥–µ–ª 11: –°—Ç—Ä—É–∫—Ç—É—Ä–∞ —Ä–æ–ª–µ–π –∏ –ø–ª–µ–π–±—É–∫–æ–≤**, –∫–æ—Ç–æ—Ä—ã–π –¥–µ—Ç–∞–ª–∏–∑–∏—Ä—É–µ—Ç —Ä–µ–∫–æ–º–µ–Ω–¥—É–µ–º—É—é –æ—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏—é –∫–æ–¥–∞ –≤ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏–∏ —Å best practices Ansible –∏ –≤–Ω—É—Ç—Ä–µ–Ω–Ω–∏–º–∏ —Å—Ç–∞–Ω–¥–∞—Ä—Ç–∞–º–∏ –æ—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏–∏.

---

## 11. –°—Ç—Ä—É–∫—Ç—É—Ä–∞ —Ä–æ–ª–µ–π –∏ –ø–ª–µ–π–±—É–∫–æ–≤

### 11.1. –û–±—â–∏–µ –ø—Ä–∏–Ω—Ü–∏–ø—ã

11.1.1. –í—Å–µ –∞–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏–∏ –¥–æ–ª–∂–Ω—ã –±—ã—Ç—å —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω—ã —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º **—Ä–æ–ª–µ–π** (roles), –∞ –Ω–µ –º–æ–Ω–æ–ª–∏—Ç–Ω—ã—Ö –ø–ª–µ–π–±—É–∫–æ–≤, –∑–∞ –∏—Å–∫–ª—é—á–µ–Ω–∏–µ–º –ø—Ä–æ—Å—Ç—ã—Ö –∏–ª–∏ —Ä–∞–∑–æ–≤—ã—Ö –∑–∞–¥–∞—á.

11.1.2. –†–æ–ª–∏ –¥–æ–ª–∂–Ω—ã –±—ã—Ç—å **–∏–¥–µ–º–ø–æ—Ç–µ–Ω—Ç–Ω—ã–º–∏**, **–º–æ–¥—É–ª—å–Ω—ã–º–∏** –∏ **–ø–æ–≤—Ç–æ—Ä–Ω–æ –∏—Å–ø–æ–ª—å–∑—É–µ–º—ã–º–∏** –≤ —Ä–∞–∑–Ω—ã—Ö –æ–∫—Ä—É–∂–µ–Ω–∏—è—Ö (dev, stage, prod).

11.1.3. –ó–∞–ø—Ä–µ—â–µ–Ω–æ –¥—É–±–ª–∏—Ä–æ–≤–∞–Ω–∏–µ –ª–æ–≥–∏–∫–∏ –º–µ–∂–¥—É —Ä–æ–ª—è–º–∏. –ü—Ä–∏ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏ ‚Äî –≤—ã–Ω–æ—Å–∏—Ç—å –æ–±—â—É—é —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç—å –≤ –æ—Ç–¥–µ–ª—å–Ω—ã–µ shared-—Ä–æ–ª–∏ –∏–ª–∏ –∫–æ–ª–ª–µ–∫—Ü–∏–∏.

---

### 11.2. –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞ (—Ä–µ–∫–æ–º–µ–Ω–¥—É–µ–º–∞—è)

–ü—Ä–æ–µ–∫—Ç –¥–æ–ª–∂–µ–Ω —Å–ª–µ–¥–æ–≤–∞—Ç—å —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–æ–π —Å—Ç—Ä—É–∫—Ç—É—Ä–µ –ø–æ [Ansible Best Practices](https://docs.ansible.com/ansible/latest/user_guide/playbooks_best_practices.html):

```
ansible-project/
‚îú‚îÄ‚îÄ inventories/
‚îÇ   ‚îú‚îÄ‚îÄ production/
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ hosts.ini
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ group_vars/
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ all.yml
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ webservers.yml
‚îÇ   ‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ databases.yml
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ host_vars/
‚îÇ   ‚îÇ       ‚îî‚îÄ‚îÄ db01.yml
‚îÇ   ‚îî‚îÄ‚îÄ staging/
‚îÇ       ‚îî‚îÄ‚îÄ ...
‚îú‚îÄ‚îÄ playbooks/
‚îÇ   ‚îú‚îÄ‚îÄ site.yml                 # –ì–ª–∞–≤–Ω—ã–π –ø–ª–µ–π–±—É–∫
‚îÇ   ‚îú‚îÄ‚îÄ webservers.yml
‚îÇ   ‚îî‚îÄ‚îÄ databases.yml
‚îú‚îÄ‚îÄ roles/
‚îÇ   ‚îú‚îÄ‚îÄ common/
‚îÇ   ‚îú‚îÄ‚îÄ nginx/
‚îÇ   ‚îú‚îÄ‚îÄ postgresql/
‚îÇ   ‚îî‚îÄ‚îÄ monitoring/
‚îú‚îÄ‚îÄ collections/
‚îÇ   ‚îî‚îÄ‚îÄ requirements.yml         # –ü—Ä–∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–∏ –≤–Ω–µ—à–Ω–∏—Ö –∫–æ–ª–ª–µ–∫—Ü–∏–π
‚îú‚îÄ‚îÄ group_vars/
‚îÇ   ‚îî‚îÄ‚îÄ all.yml                  # –ì–ª–æ–±–∞–ª—å–Ω—ã–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ (–µ—Å–ª–∏ –Ω–µ –≤ inventories/)
‚îú‚îÄ‚îÄ host_vars/
‚îú‚îÄ‚îÄ ansible.cfg
‚îú‚îÄ‚îÄ requirements.yml             # –ó–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ —Ä–æ–ª–µ–π (Ansible Galaxy)
‚îú‚îÄ‚îÄ .ansible-lint
‚îú‚îÄ‚îÄ .gitignore
‚îî‚îÄ‚îÄ README.md
```

> **–ü—Ä–∏–º–µ—á–∞–Ω–∏–µ:** –î–ª—è –Ω–µ–±–æ–ª—å—à–∏—Ö –ø—Ä–æ–µ–∫—Ç–æ–≤ –¥–æ–ø—É—Å–∫–∞–µ—Ç—Å—è —É–ø—Ä–æ—â—ë–Ω–Ω–∞—è —Å—Ç—Ä—É–∫—Ç—É—Ä–∞, –Ω–æ —Å —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ–º –ª–æ–≥–∏—á–µ—Å–∫–æ–≥–æ —Ä–∞–∑–¥–µ–ª–µ–Ω–∏—è.

---

### 11.3. –°—Ç—Ä—É–∫—Ç—É—Ä–∞ —Ä–æ–ª–∏

–ö–∞–∂–¥–∞—è —Ä–æ–ª—å –¥–æ–ª–∂–Ω–∞ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–æ–≤–∞—Ç—å —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–æ–π —Å—Ç—Ä—É–∫—Ç—É—Ä–µ Ansible:

```
roles/<role_name>/
‚îú‚îÄ‚îÄ defaults/
‚îÇ   ‚îî‚îÄ‚îÄ main.yml                 # –ó–Ω–∞—á–µ–Ω–∏—è –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é (–Ω–∏–∑–∫–∏–π –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç)
‚îú‚îÄ‚îÄ vars/
‚îÇ   ‚îî‚îÄ‚îÄ main.yml                 # –ü–µ—Ä–µ–º–µ–Ω–Ω—ã–µ —Ä–æ–ª–∏ (–≤—ã—Å–æ–∫–∏–π –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç)
‚îú‚îÄ‚îÄ tasks/
‚îÇ   ‚îî‚îÄ‚îÄ main.yml                 # –û—Å–Ω–æ–≤–Ω–æ–π —Å–ø–∏—Å–æ–∫ –∑–∞–¥–∞—á
‚îú‚îÄ‚îÄ handlers/
‚îÇ   ‚îî‚îÄ‚îÄ main.yml                 # –û–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ (notify)
‚îú‚îÄ‚îÄ templates/
‚îÇ   ‚îî‚îÄ‚îÄ *.j2                     # Jinja2-—à–∞–±–ª–æ–Ω—ã –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–æ–Ω–Ω—ã—Ö —Ñ–∞–π–ª–æ–≤
‚îú‚îÄ‚îÄ files/
‚îÇ   ‚îî‚îÄ‚îÄ *                        # –°—Ç–∞—Ç–∏—á–µ—Å–∫–∏–µ —Ñ–∞–π–ª—ã –¥–ª—è –∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏—è
‚îú‚îÄ‚îÄ meta/
‚îÇ   ‚îî‚îÄ‚îÄ main.yml                 # –ú–µ—Ç–∞–¥–∞–Ω–Ω—ã–µ (–∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏, –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ–º—ã–µ –û–°)
‚îú‚îÄ‚îÄ tests/
‚îÇ   ‚îú‚îÄ‚îÄ inventory
‚îÇ   ‚îî‚îÄ‚îÄ test.yml                 # –ü—Ä–∏–º–µ—Ä –∑–∞–ø—É—Å–∫–∞ –¥–ª—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è
‚îî‚îÄ‚îÄ README.md                    # –û–ø–∏—Å–∞–Ω–∏–µ —Ä–æ–ª–∏, –ø–∞—Ä–∞–º–µ—Ç—Ä—ã, –ø—Ä–∏–º–µ—Ä—ã
```

**–¢—Ä–µ–±–æ–≤–∞–Ω–∏—è –∫ —Å–æ–¥–µ—Ä–∂–∏–º–æ–º—É:**

- –í `defaults/main.yml` ‚Äî —Ç–æ–ª—å–∫–æ –±–µ–∑–æ–ø–∞—Å–Ω—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é.
- –í `vars/main.yml` ‚Äî –∑–Ω–∞—á–µ–Ω–∏—è, –∫–æ—Ç–æ—Ä—ã–µ –Ω–µ –ø—Ä–µ–¥–ø–æ–ª–∞–≥–∞–µ—Ç—Å—è –ø–µ—Ä–µ–æ–ø—Ä–µ–¥–µ–ª—è—Ç—å –∏–∑–≤–Ω–µ.
- –í—Å–µ –ø—É—Ç–∏ –∫ —Ñ–∞–π–ª–∞–º –∏ —à–∞–±–ª–æ–Ω–∞–º ‚Äî –æ—Ç–Ω–æ—Å–∏—Ç–µ–ª—å–Ω—ã–µ (Ansible –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –∏—â–µ—Ç –≤ `files/` –∏ `templates/`).
- –í `meta/main.yml` –æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ —É–∫–∞–∑—ã–≤–∞—Ç—å:
  - –ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ–º—ã–µ –û–° (`galaxy_info.platforms`);
  - –ó–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç –¥—Ä—É–≥–∏—Ö —Ä–æ–ª–µ–π (–µ—Å–ª–∏ –µ—Å—Ç—å);
  - –ú–∏–Ω–∏–º–∞–ª—å–Ω—É—é –≤–µ—Ä—Å–∏—é Ansible.

---

### 11.4. –ü–ª–µ–π–±—É–∫–∏

11.4.1. –ü–ª–µ–π–±—É–∫–∏ –¥–æ–ª–∂–Ω—ã –±—ã—Ç—å **–¥–µ–∫–ª–∞—Ä–∞—Ç–∏–≤–Ω—ã–º–∏** –∏ **–æ—Ä–∏–µ–Ω—Ç–∏—Ä–æ–≤–∞–Ω–Ω—ã–º–∏ –Ω–∞ –∏–Ω–≤–µ–Ω—Ç–∞—Ä—å**.

11.4.2. –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –≤–∫–ª—é—á–µ–Ω–∏—è (`import_playbook`, `include_role`) –¥–ª—è –º–æ–¥—É–ª—å–Ω–æ—Å—Ç–∏:

```yaml
# playbooks/site.yml
- name: Configure common settings
  hosts: all
  roles:
    - common

- name: Deploy web servers
  hosts: webservers
  roles:
    - nginx
    - monitoring
```

11.4.3. –ó–∞–ø—Ä–µ—â–µ–Ω–æ –∂—ë—Å—Ç–∫–æ –ø—Ä–æ–ø–∏—Å—ã–≤–∞—Ç—å —Ö–æ—Å—Ç—ã –∏–ª–∏ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –≤–Ω—É—Ç—Ä–∏ –ø–ª–µ–π–±—É–∫–∞. –í—Å—ë ‚Äî —á–µ—Ä–µ–∑ inventory –∏–ª–∏ –≤–Ω–µ—à–Ω–∏–µ vars.

11.4.4. –î–ª—è —Å–ª–æ–∂–Ω—ã—Ö —Å—Ü–µ–Ω–∞—Ä–∏–µ–≤ (–Ω–∞–ø—Ä–∏–º–µ—Ä, blue/green deployment) –¥–æ–ø—É—Å–∫–∞–µ—Ç—Å—è –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –±–ª–æ–∫–æ–≤ `block`, `rescue`, `always`.

---

### 11.5. –ü–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –∏ –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç—ã

11.5.1. –°–ª–µ–¥–æ–≤–∞—Ç—å [–æ—Ñ–∏—Ü–∏–∞–ª—å–Ω–æ–π –∏–µ—Ä–∞—Ä—Ö–∏–∏ –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç–æ–≤ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö Ansible](https://docs.ansible.com/ansible/latest/playbook_guide/playbooks_variables.html#understanding-variable-precedence).

11.5.2. –†–µ–∫–æ–º–µ–Ω–¥—É–µ–º—ã–π –ø–æ—Ä—è–¥–æ–∫ –∑–∞–¥–∞–Ω–∏—è –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö (–æ—Ç –Ω–∏–∑–∫–æ–≥–æ –∫ –≤—ã—Å–æ–∫–æ–º—É –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç—É):
- `roles/<role>/defaults/main.yml`
- `group_vars/`, `host_vars/`
- `inventories/<env>/group_vars/`
- Extra vars (`-e` –∏–ª–∏ —á–µ—Ä–µ–∑ CI/CD)

11.5.3. –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å **–ø—Ä–µ—Ñ–∏–∫—Å—ã** –¥–ª—è –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö —Ä–æ–ª–∏, —á—Ç–æ–±—ã –∏–∑–±–µ–∂–∞—Ç—å –∫–æ–ª–ª–∏–∑–∏–π:
```yaml
# –•–æ—Ä–æ—à–æ
nginx_port: 80
nginx_worker_connections: 1024

# –ü–ª–æ—Ö–æ
port: 80  # –Ω–µ–æ—á–µ–≤–∏–¥–Ω–æ, –∫ —á–µ–º—É –æ—Ç–Ω–æ—Å–∏—Ç—Å—è
```

---

### 11.6. –ö–æ–ª–ª–µ–∫—Ü–∏–∏ –∏ –≤–Ω–µ—à–Ω–∏–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏

11.6.1. –í–Ω–µ—à–Ω–∏–µ —Ä–æ–ª–∏ –∏ –∫–æ–ª–ª–µ–∫—Ü–∏–∏ –ø–æ–¥–∫–ª—é—á–∞—é—Ç—Å—è —á–µ—Ä–µ–∑ —Ñ–∞–π–ª `requirements.yml`:

```yaml
# requirements.yml
collections:
  - name: community.general
  - name: amazon.aws

roles:
  - src: geerlingguy.docker
    version: 3.4.0
```

11.6.2. –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π –≤—ã–ø–æ–ª–Ω—è–µ—Ç—Å—è –∫–æ–º–∞–Ω–¥–æ–π:
```bash
ansible-galaxy install -r requirements.yml --roles-path ./roles
ansible-galaxy collection install -r requirements.yml
```

11.6.3. –í–µ—Ä—Å–∏–∏ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π **—Ñ–∏–∫—Å–∏—Ä–æ–≤–∞—Ç—å —è–≤–Ω–æ** (–Ω–∏–∫–∞–∫–∏—Ö `latest` –≤ production).

---

### 11.7. –ò–º–µ–Ω–æ–≤–∞–Ω–∏–µ

11.7.1. –ò–º–µ–Ω–∞ —Ä–æ–ª–µ–π, –ø–ª–µ–π–±—É–∫–æ–≤, –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö ‚Äî –Ω–∞ **–∞–Ω–≥–ª–∏–π—Å–∫–æ–º —è–∑—ã–∫–µ**, –≤ **snake_case**.

11.7.2. –ò–º–µ–Ω–∞ –∑–∞–¥–∞—á ‚Äî –ø–æ–Ω—è—Ç–Ω—ã–µ, –≤ –ø–æ–≤–µ–ª–∏—Ç–µ–ª—å–Ω–æ–º –Ω–∞–∫–ª–æ–Ω–µ–Ω–∏–∏:
```yaml
- name: Install nginx package
  apt:
    name: nginx
    state: present
```

11.7.3. –ò–∑–±–µ–≥–∞—Ç—å –æ–±–æ–±—â—ë–Ω–Ω—ã—Ö –∏–º—ë–Ω (`config.yml`, `setup.yml`) ‚Äî –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –∫–æ–Ω–∫—Ä–µ—Ç–∏–∫—É (`configure_nginx.yml`, `install_postgres.yml`).

---

–≠—Ç–æ—Ç —Ä–∞–∑–¥–µ–ª –º–æ–∂–Ω–æ –≤–∫–ª—é—á–∏—Ç—å –≤ –æ—Å–Ω–æ–≤–Ω–æ–π —Ä–µ–≥–ª–∞–º–µ–Ω—Ç –∫–∞–∫ **–ø—É–Ω–∫—Ç 11** –∏–ª–∏ –∫–∞–∫ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ ¬´A. –°—Ç–∞–Ω–¥–∞—Ä—Ç—ã –æ—Ñ–æ—Ä–º–ª–µ–Ω–∏—è Ansible-–∫–æ–¥–∞¬ª.

–ï—Å–ª–∏ –≤—ã –∏—Å–ø–æ–ª—å–∑—É–µ—Ç–µ **Ansible Collections** (–∞ –Ω–µ —Ç–æ–ª—å–∫–æ —Ä–æ–ª–∏), –º–æ–∂–Ω–æ –¥–æ–±–∞–≤–∏—Ç—å –æ—Ç–¥–µ–ª—å–Ω—ã–π –ø–æ–¥—Ä–∞–∑–¥–µ–ª –ø—Ä–æ —Å—Ç—Ä—É–∫—Ç—É—Ä—É –∫–æ–ª–ª–µ–∫—Ü–∏–π. –¢–∞–∫–∂–µ –º–æ–∂–Ω–æ –ø—Ä–∏–ª–æ–∂–∏—Ç—å **—á–µ–∫-–ª–∏—Å—Ç —Ä–µ–≤—å—é** –¥–ª—è merge request‚Äô–æ–≤.

–ù—É–∂–µ–Ω —à–∞–±–ª–æ–Ω `.ansible-lint`, –ø—Ä–∏–º–µ—Ä `ansible.cfg` –∏–ª–∏ CI-–ø–∞–π–ø–ª–∞–π–Ω –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ —Ä–æ–ª–µ–π?

–û—Ç–ª–∏—á–Ω–æ! –ù–∏–∂–µ –≤—ã –Ω–∞–π–¥—ë—Ç–µ:

1. **–®–∞–±–ª–æ–Ω `.ansible-lint`** ‚Äî –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è –ª–∏–Ω—Ç–µ—Ä–∞ –¥–ª—è —Å–æ–±–ª—é–¥–µ–Ω–∏—è —Å—Ç–∞–Ω–¥–∞—Ä—Ç–æ–≤ –∫–æ–¥–∞.  
2. **–ü—Ä–∏–º–µ—Ä `ansible.cfg`** ‚Äî —Ü–µ–Ω—Ç—Ä–∞–ª–∏–∑–æ–≤–∞–Ω–Ω–∞—è –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è Ansible.  
3. **–ü—Ä–∏–º–µ—Ä CI/CD-–ø–∞–π–ø–ª–∞–π–Ω–∞** (–Ω–∞ –æ—Å–Ω–æ–≤–µ GitLab CI, –Ω–æ –ª–µ–≥–∫–æ –∞–¥–∞–ø—Ç–∏—Ä—É–µ—Ç—Å—è –ø–æ–¥ GitHub Actions/Jenkins) –¥–ª—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–π –ø—Ä–æ–≤–µ—Ä–∫–∏ —Ä–æ–ª–µ–π –∏ –ø–ª–µ–π–±—É–∫–æ–≤.

–í—Å–µ —Ñ–∞–π–ª—ã —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—Ç best practices –∏ –º–æ–≥—É—Ç –±—ã—Ç—å –≤–∫–ª—é—á–µ–Ω—ã –≤ –≤–∞—à —Ä–µ–≥–ª–∞–º–µ–Ω—Ç –∫–∞–∫ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è.

---

## 1. –®–∞–±–ª–æ–Ω `.ansible-lint`

–§–∞–π–ª `.ansible-lint` —Ä–∞–∑–º–µ—â–∞–µ—Ç—Å—è –≤ –∫–æ—Ä–Ω–µ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏—è –∏ –Ω–∞—Å—Ç—Ä–∞–∏–≤–∞–µ—Ç –ø–æ–≤–µ–¥–µ–Ω–∏–µ `ansible-lint`.

```yaml
# .ansible-lint
---
# –£—Ä–æ–≤–µ–Ω—å —Å—Ç—Ä–æ–≥–æ—Å—Ç–∏: production (—Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è)
strict: true

# –û—Ç–∫–ª—é—á–µ–Ω–∏–µ –ø—Ä–∞–≤–∏–ª (—Ç–æ–ª—å–∫–æ –ø—Ä–∏ –æ–±–æ—Å–Ω–æ–≤–∞–Ω–Ω–æ–π –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏!)
skip_list:
  # –ü—Ä–∏–º–µ—Ä: –æ—Ç–∫–ª—é—á–∏—Ç—å –ø—Ä–∞–≤–∏–ª–æ –æ –¥—É–±–ª–∏—Ä–æ–≤–∞–Ω–∏–∏ –∑–∞–¥–∞—á (–µ—Å–ª–∏ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è include)
  # - 'no-duplicate-tasks'
  # - 'yaml[line-length]'  # –µ—Å–ª–∏ –Ω–µ —Ö–æ—Ç–∏—Ç–µ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ 120 —Å–∏–º–≤–æ–ª–æ–≤

# –ü—É—Ç–∏ –¥–ª—è –∞–Ω–∞–ª–∏–∑–∞ (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é ‚Äî –≤—Å—ë, –Ω–æ –º–æ–∂–Ω–æ —É—Ç–æ—á–Ω–∏—Ç—å)
exclude_paths:
  - .git/
  - .venv/
  - tests/
  - .cache/

# –ü–ª–∞–≥–∏–Ω—ã (–µ—Å–ª–∏ –∏—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è –∫–∞—Å—Ç–æ–º–Ω—ã–µ)
# rulesdir: ./lint-rules/

# –§–æ—Ä–º–∞—Ç –≤—ã–≤–æ–¥–∞ (default, codeclimate, sarif –∏ –¥—Ä.)
format: default
```

> üí° **–°–æ–≤–µ—Ç**: –ù–µ –æ—Ç–∫–ª—é—á–∞–π—Ç–µ –ø—Ä–∞–≤–∏–ª–∞ –±–µ–∑ –≤–µ—Å–∫–æ–π –ø—Ä–∏—á–∏–Ω—ã. –ü—Ä–∏ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏ ‚Äî –¥–æ–∫—É–º–µ–Ω—Ç–∏—Ä—É–π—Ç–µ –∏—Å–∫–ª—é—á–µ–Ω–∏—è –≤ –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏—è—Ö –∫–æ–¥–∞ —Å –ø–æ–º–æ—â—å—é `# noqa <rule-id>`.

---

## 2. –ü—Ä–∏–º–µ—Ä `ansible.cfg`

–§–∞–π–ª `ansible.cfg` –≤ –∫–æ—Ä–Ω–µ –ø—Ä–æ–µ–∫—Ç–∞ –æ–±–µ—Å–ø–µ—á–∏–≤–∞–µ—Ç –µ–¥–∏–Ω–æ–æ–±—Ä–∞–∑–Ω–æ–µ –ø–æ–≤–µ–¥–µ–Ω–∏–µ Ansible –¥–ª—è –≤—Å–µ—Ö —É—á–∞—Å—Ç–Ω–∏–∫–æ–≤ –∫–æ–º–∞–Ω–¥—ã –∏ CI.

```ini
# ansible.cfg
[defaults]
# –ü—É—Ç–∏
inventory = inventories/production/hosts.ini
roles_path = roles
collections_paths = collections

# –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å
host_key_checking = True
deprecation_warnings = False
command_warnings = False

# –ß–∏—Ç–∞–µ–º–æ—Å—Ç—å –≤—ã–≤–æ–¥–∞
stdout_callback = yaml
callback_whitelist = profile_tasks, timer

# –§–∞–∫—Ç—ã
gathering = smart
fact_caching = jsonfile
fact_caching_connection = /tmp/ansible_fact_cache
fact_caching_timeout = 86400

# –£–ª—É—á—à–µ–Ω–∏–µ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏
forks = 20
pipelining = True
ssh_args = -o ControlMaster=auto -o ControlPersist=60s -o PreferredAuthentications=publickey
control_path = %(directory)s/%%h-%%r

# Vault
vault_password_file = .vault_pass.py  # –∏–ª–∏ .vault_pass (–µ—Å–ª–∏ plaintext, –Ω–æ –Ω–µ –≤ —Ä–µ–ø–æ!)

# –ö–æ–ª–ª–µ–∫—Ü–∏–∏
interpreter_python = auto_silent

[inventory]
# –†–∞–∑—Ä–µ—à–∏—Ç—å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –ø–ª–∞–≥–∏–Ω–æ–≤ inventory (–Ω–∞–ø—Ä–∏–º–µ—Ä, AWS EC2 dynamic inventory)
enable_plugins = host_list, script, auto, yaml, ini, toml

[ssh_connection]
ssh_args = -o ControlMaster=auto -o ControlPersist=60s -o PreferredAuthentications=publickey
control_path_dir = ~/.ansible/cp
```

> ‚ö†Ô∏è **–í–∞–∂–Ω–æ**:  
> - –§–∞–π–ª `.vault_pass.py` (–∏–ª–∏ `.vault_pass`) **–Ω–µ –¥–æ–ª–∂–µ–Ω –ø–æ–ø–∞–¥–∞—Ç—å –≤ Git**. –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ CI-–ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –∏–ª–∏ —Å–µ–∫—Ä–µ—Ç-–º–µ–Ω–µ–¥–∂–µ—Ä—ã.  
> - –î–ª—è CI –º–æ–∂–Ω–æ –ø–µ—Ä–µ–æ–ø—Ä–µ–¥–µ–ª—è—Ç—å `inventory` –∏ `vault_password_file` —á–µ—Ä–µ–∑ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è (`ANSIBLE_INVENTORY`, `ANSIBLE_VAULT_PASSWORD_FILE`).

---

## 3. –ü—Ä–∏–º–µ—Ä CI/CD-–ø–∞–π–ø–ª–∞–π–Ω–∞ (GitLab CI)

–§–∞–π–ª `.gitlab-ci.yml` ‚Äî –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ –ø—Ä–∏ –ø—É—à–µ –∏–ª–∏ MR.

```yaml
# .gitlab-ci.yml
stages:
  - lint
  - test
  - validate

variables:
  ANSIBLE_FORCE_COLOR: "1"
  ANSIBLE_HOST_KEY_CHECKING: "False"
  PIP_CACHE_DIR: "$CI_PROJECT_DIR/.cache/pip"

cache:
  paths:
    - .cache/pip
    - .venv/

before_script:
  - python -V
  - pip install virtualenv
  - virtualenv .venv
  - source .venv/bin/activate
  - pip install --upgrade pip
  - pip install ansible ansible-lint yamllint molecule[docker] testinfra

lint:ansible:
  stage: lint
  script:
    - ansible-lint --version
    - ansible-lint -v

lint:yamllint:
  stage: lint
  script:
    - yamllint -c .yamllint .

test:roles:
  stage: test
  services:
    - docker:dind
  variables:
    DOCKER_HOST: tcp://docker:2375
    DOCKER_TLS_CERTDIR: ""
  script:
    - |
      for role in roles/*; do
        if [ -d "$role" ]; then
          echo "üß™ Testing role: $(basename $role)"
          cd "$role"
          if [ -f "molecule/default/molecule.yml" ]; then
            molecule test
          else
            echo "‚ö†Ô∏è  No Molecule config ‚Äî skipping"
          fi
          cd "$CI_PROJECT_DIR"
        fi
      done

validate:syntax:
  stage: validate
  script:
    - ansible-playbook --syntax-check playbooks/*.yml
```

### –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ: `.yamllint` (–¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ YAML-—Å–∏–Ω—Ç–∞–∫—Å–∏—Å–∞)

```yaml
# .yamllint
---
extends: default

rules:
  line-length:
    max: 120
    level: warning
  braces:
    min-spaces-inside: 0
    max-spaces-inside: 1
  brackets:
    min-spaces-inside: 0
    max-spaces-inside: 1
  truthy:
    allowed-values: ["true", "false", "on", "off", "yes", "no"]
    check-keys: false
  comments:
    min-spaces-from-content: 1
```

---

## –ö–∞–∫ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å

1. –ü–æ–º–µ—Å—Ç–∏—Ç–µ `.ansible-lint`, `ansible.cfg`, `.yamllint` –≤ –∫–æ—Ä–µ–Ω—å —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏—è.
2. –ù–∞—Å—Ç—Ä–æ–π—Ç–µ CI/CD (GitLab CI, GitHub Actions –∏ —Ç.–¥.) –ø–æ –ø—Ä–∏–º–µ—Ä—É –≤—ã—à–µ.
3. –û–±—è–∑–∞—Ç–µ–ª—å–Ω–æ –¥–æ–±–∞–≤—å—Ç–µ –≤ `.gitignore`:
   ```
   .vault_pass
   .vault_pass.py
   .venv/
   *.retry
   /tmp/
   ```

---

## –ê–¥–∞–ø—Ç–∞—Ü–∏—è –ø–æ–¥ –¥—Ä—É–≥–∏–µ CI

- **GitHub Actions**: –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ –æ—Ñ–∏—Ü–∏–∞–ª—å–Ω—ã–π action [`ansible-lint`](https://github.com/ansible/ansible-lint) –∏ `molecule` —á–µ—Ä–µ–∑ `actions/setup-python`.
- **Jenkins**: –∑–∞–ø—É—Å–∫–∞–π—Ç–µ —Ç–µ –∂–µ –∫–æ–º–∞–Ω–¥—ã –≤ pipeline-—Å–∫—Ä–∏–ø—Ç–µ —Å –≤–∏—Ä—Ç—É–∞–ª—å–Ω—ã–º –æ–∫—Ä—É–∂–µ–Ω–∏–µ–º.

---

–ï—Å–ª–∏ –≤—ã –∏—Å–ø–æ–ª—å–∑—É–µ—Ç–µ **Ansible AWX/Tower**, –º–æ–∂–Ω–æ —Ç–∞–∫–∂–µ –¥–æ–±–∞–≤–∏—Ç—å —Ä–∞–∑–¥–µ–ª –æ —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏ –ø—Ä–æ–µ–∫—Ç–æ–≤ –∏–∑ Git –∏ –ø—Ä–æ–≤–µ—Ä–∫–µ —á–µ—Ä–µ–∑ Job Templates.

–ù—É–∂–Ω—ã —à–∞–±–ª–æ–Ω—ã –¥–ª—è GitHub Actions –∏–ª–∏ –ø—Ä–∏–º–µ—Ä Molecule-–∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏ –¥–ª—è —Ä–æ–ª–∏?